# Migration `20200622173805-remove-props-from-user`

This migration has been generated by Malcolm Nihl√©n at 6/22/2020, 5:38:05 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
DROP INDEX "public"."FieldData.fieldName"

DROP INDEX "public"."User.email"

DROP INDEX "public"."User.username"

ALTER TABLE "public"."Card" DROP CONSTRAINT IF EXiSTS "Card_deckId_fkey",
DROP CONSTRAINT IF EXiSTS "Card_typeId_fkey",
DROP COLUMN "deckId",
DROP COLUMN "typeId";

ALTER TABLE "public"."Note" ADD COLUMN "deckId" text  NOT NULL ;

ALTER TABLE "public"."NoteType" ADD COLUMN "userId" text  NOT NULL ;

ALTER TABLE "public"."User" DROP COLUMN "email",
DROP COLUMN "password",
DROP COLUMN "username",
ALTER COLUMN "role" SET DEFAULT E'USER';

CREATE UNIQUE INDEX "FieldData.fieldName_noteId" ON "public"."FieldData"("fieldName","noteId")

ALTER TABLE "public"."Note" ADD FOREIGN KEY ("deckId")REFERENCES "public"."Deck"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."NoteType" ADD FOREIGN KEY ("userId")REFERENCES "public"."User"("id") ON DELETE CASCADE  ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200613124503-prisma-refactor..20200622173805-remove-props-from-user
--- datamodel.dml
+++ datamodel.dml
@@ -2,9 +2,9 @@
 // learn more about it in the docs: https://pris.ly/d/prisma-schema
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url      = env("DATABASE_URL")
 }
 generator client {
   provider = "prisma-client-js"
@@ -16,11 +16,8 @@
 }
 model User {
   id        String      @id @default(cuid())
-  username  String      @unique
-  email     String      @unique
-  password  String
   role      Role        @default(USER)
   decks     Deck[]
   noteTypes NoteType[]
   createdAt DateTime    @default(now())
```


